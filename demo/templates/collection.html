{% extends "layout.html" %}
{% block body %}
<style>
  .h2{
    height:80px;
  }
  .h3{
    height:80px;
  }
  .section{
    height: 80px;
  }
.container{
  height: 100vh;
  overflow: hidden;
}
.row {
  height: calc(100% - 320px);
  position: relative;
}
.column {
  position: relative;
  float: left;
  width: 50%;
  height: 100%;
}


#left {
    float: left;
    width: 50%;
    overflow: auto;
}
#right {
    float: left;
    width: 50%;
}
#tb_attr{
  table-layout: auto;
}

/* Clear floats after the columns */
.row:after {
  height: 100%;
  content: "";
  display: table;
  clear: both;
}
.footer{
  height: 80px;
}






</style>

<div class="section bg-gray">
    <ul class="breadcrumb">
        <li class="breadcrumb-item">
            <a href="{{ url_for('root') }}">/ home</a>
        </li>
        <li class="breadcrumb-item">
            <a href="{{ url_for('collections') }}">collections</a>
        </li>
        <li class="breadcrumb-item">
            <a href="{{ request.path }}">{{ dataset['name'] }}</a>
        </li>
    </ul>
</div>

<div class="row">
    <div class="column" id="left">
        <h2>Dataset: {{ dataset['name'] }}</h2>

        <p><span class="chip">Description: </span> {{ dataset['title'] }} </p>

        <h3>View</h3>

        <p><a href="{{ url_for('collections') }}{{ dataset['name'] }}/items">Browse though the features of the dataset
            (HTML page)</a></p>

        <h3>Links</h3>

        <p><a href="{{ url_for('collections') }}{{ dataset['name'] }}/items/?f=json">Get the CityJSON file
            (~FeatureCollection)</a></p>

        <div class="columns ">
            <div><h3>Attributes Filtering</h3></div>
            <div>&nbsp&nbsp<a id="attr" href="{{ url_for('collections') }}{{ dataset['name']}}">
                <button class="btn btn-primary">Confirm</button>
            </a></div>
        </div>

        <table id='tb_attr' class="table table-striped table-hover">
            <tr>
                <th>attribute name</th>
                <th>values</th>
                <th>operator</th>
            </tr>

            {% for key, value in meta_attr.items() %}
            <td>{{ key }}</td>

            {% if value[0] is string%}
            <td>
                {% for i in value %}

                <div class="form-group">
                    <label class="form-checkbox">
                        <input type="checkbox">
                        <i class="form-icon"></i> {{ i }}
                    </label>
                </div>
                {% endfor %}
            </td>
            <td>
                Enumeration
            </td>


            {% else %}
            <td>
                <!-- normal slider -->
                <div class="columns">
                    <div>{{value[0]}}&nbsp&nbsp</div>
                    <div><input class="slider tooltip" type="range" min={{value[0]}}
                                max={{value[1]}} value="{{value[0]}}"
                                oninput="this.setAttribute('value', this.value);"></div>

                    <div>&nbsp&nbsp{{value[1]}}</div>
                </div>
            </td>
            <td>
                <!-- standard Accordions example -->
                <!-- basic dropdown button -->
                <!-- dropdown button group -->
                <div class="dropdown">
                    <div class="btn-group">
                        <a id="selected_oper" href="#" class="btn">
                            Equal
                        </a>
                        <a href="#" class="btn dropdown-toggle" tabindex="0">
                            <i class="icon icon-caret"></i>
                        </a>

                        <!-- menu component -->
                        <ul class="menu">
                            <li id="eq" class="menu-item"><a href="#">Equal to</a></li>
                            <li id="bt" class="menu-item"><a href="#">Bigger than</a></li>
                            <li id="bet" class="menu-item"><a href="#">Bigger and equal than</a></li>
                            <li id="st" class="menu-item"><a href="#">Smaller than</a></li>
                            <li id="set" class="menu-item"><a href="#">Smaller and equal than</a></li>

                        </ul>

                    </div>
                </div>
            </td>


            {% endif %}

            </tr>
            {% endfor %}


        </table>

    </div>
    <div class="column" id="right">
        <div id="bbox_table">
            <table class="table table-striped table-hover">

                <tr>
                    <td>Bounding box transformed (EPSG:4326)</td>
                    <td id="transformed_bounds">{{ bounds }}</td>
                </tr>
                <tr>
                    <td id="bounds_original">Bounding box (EPSG:{{ crs|int }})</td>
                    <td>{{ bounds_original }}</td>
                </tr>
                <tr>
                    <td>Select bounding box</td>
                    <td>
                        <div class="columns col-oneline">
                            <input class="form-input" type="text" id="epsg" placeholder="EPSG">
                            <a id="bbox" href="{{ url_for('collections') }}{{ dataset['name']}}">
                                <button class="btn btn-primary">Confirm</button>
                            </a>

                        </div>

                        <div class="columns col-oneline">
                            <input class="form-input" type="text" id="minY" placeholder="minimum Y ">
                            <input class="form-input" type="text" id="minX" placeholder="minimum X">
                        </div>
                        <div class="columns col-oneline">
                            <input class="form-input" type="text" id="maxY" placeholder="maximum Y">
                            <input class="form-input" type="text" id="maxX" placeholder="maximum X">
                        </div>


                    </td>
                </tr>
            </table>
        </div>

        <br>
        <div id="visualise2d" class="center">
            {% include 'visualise2d.html' %}

        </div>
    </div>
</div>

<script>
var epsg={{ crs }}
console.log(epsg)
if (epsg==0){
let warning= "<div class='toast toast-warning'>The dataset has no crs infomation.</div>";
 $("#bbox_table").html(warning);

}

$("#bbox").click(function(){
var minX=$('#minX').val();
var minY=$('#minY').val();
var maxX=$('#maxX').val();
var maxY=$('#maxY').val();
var epsg=$('#epsg').val();

this.href=this.href+'/?bbox='+minX+','+minY+','+maxX+','+maxY+'&epsg='+epsg;
console.log(this.href);

$("#bt").click(function(){
    $(#selected_oper).val($("#bt").val());
});
})


























</script>
{% endblock %}